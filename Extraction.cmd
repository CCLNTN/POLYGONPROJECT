@echo off setlocal enabledelayedexpansion echo Extracting .gz files from monthly subdirectories... REM Extract DAILY Aggregate Files (Skip if already extracted) for /D %%m in ("Z:\2025\DAILY\GZFILES\*") do (     for %%f in ("%%m\*.gz") do (         set "output_file=Z:\2025\DAILY\EXTRACTEDFILES\%%~nf.csv"         if not exist "!output_file!" (             echo Extracting %%f...             "C:\Program Files\7-Zip\7z.exe" e -y "%%f" -o"Z:\2025\DAILY\EXTRACTEDFILES\"         ) else (             echo Skipping %%f - Already extracted.         )     ) ) REM Extract TRADES Files (Skip if already extracted) for /D %%m in ("Z:\2025\TRADES\GZFILES\*") do (     for %%f in ("%%m\*.gz") do (         set "output_file=Z:\2025\TRADES\EXTRACTEDFILES\%%~nf.csv"         if not exist "!output_file!" (             echo Extracting %%f...             "C:\Program Files\7-Zip\7z.exe" e -y "%%f" -o"Z:\2025\TRADES\EXTRACTEDFILES\"         ) else (             echo Skipping %%f - Already extracted.         )     ) ) REM Extract QUOTES Files (Skip if already extracted) for /D %%m in ("Z:\2025\QUOTES\GZFILES\*") do (     for %%f in ("%%m\*.gz") do (         set "output_file=Z:\2025\QUOTES\EXTRACTEDFILES\%%~nf.csv"         if not exist "!output_file!" (             echo Extracting %%f...             "C:\Program Files\7-Zip\7z.exe" e -y "%%f" -o"Z:\2025\QUOTES\EXTRACTEDFILES\"         ) else (             echo Skipping %%f - Already extracted.         )     ) ) echo Extraction Complete! Only new files were processed.
